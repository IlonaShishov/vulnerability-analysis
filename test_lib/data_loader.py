import os
import json

def load_test_data(examples_dir):

    test_data = {}

    for output_file in os.listdir(examples_dir):
        if output_file.endswith('.json'):
            output_path = os.path.join(examples_dir, output_file)
            with open(output_path, 'r') as f:
                output_data = json.load(f)
                
                image_id = output_data["input"]["scan"]["id"]
                for output in output_data["output"]:
                    cve_id = output["vuln_id"]
                    case_id = f'{cve_id}-{image_id}'
                    if case_id in test_data:
                        test_data[case_id].append(output)
                    else:
                        test_data[case_id] = [output]

    return test_data
